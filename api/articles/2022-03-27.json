{"title":"基于Bevy的扫雷游戏(2)","uid":"29b1341e2b77e066dddc7ec9ddd945fe","slug":"2022-03-27","date":"2022-03-27T06:02:47.000Z","updated":"2024-03-06T02:36:48.103Z","comments":true,"path":"api/articles/2022-03-27.json","keywords":"Programming, Web, Frontend, Backend ,Rust, Blog, Aurora, Fontlos, 芳塔洛斯","cover":"https://fontlos.com/cover/bevy.svg","content":"<div class=\"custom-quote warning\">\n<span class=\"custom-quote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M12 8V13\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M12 15.99V16.01\"></path>\n</svg>\n</span>\n<p class=\"custom-quote-title\">注意</p>\n<p>文章重写中</p>\n</div>\n<h1 id=\"Board-Options\"><a href=\"#Board-Options\" class=\"headerlink\" title=\"Board Options\"></a>Board Options</h1><p>下面我们来添加一个 <code>board_options</code> 模块, 现在我们的文件树类似于下面这样</p>\n<div class=\"language-txt\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">txt</span><pre class=\"shiki one-dark-pro\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #abb2bf\">│  lib.rs</span></span>\n<span class=\"line\"><span style=\"color: #abb2bf\">│  main.rs</span></span>\n<span class=\"line\"><span style=\"color: #abb2bf\">│</span></span>\n<span class=\"line\"><span style=\"color: #abb2bf\">├─components</span></span>\n<span class=\"line\"><span style=\"color: #abb2bf\">│      coordinates.rs</span></span>\n<span class=\"line\"><span style=\"color: #abb2bf\">│      mod.rs</span></span>\n<span class=\"line\"><span style=\"color: #abb2bf\">│</span></span>\n<span class=\"line\"><span style=\"color: #abb2bf\">└─resources</span></span>\n<span class=\"line\"><span style=\"color: #abb2bf\">        board_options.rs</span></span>\n<span class=\"line\"><span style=\"color: #abb2bf\">        mod.rs</span></span>\n<span class=\"line\"><span style=\"color: #abb2bf\">        tile.rs</span></span>\n<span class=\"line\"><span style=\"color: #abb2bf\">        tile_map.rs</span></span></code></pre></div><p>在 <code>mod</code> 文件中添加如下内容</p>\n<div class=\"language-rust\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">rust</span><pre class=\"shiki one-dark-pro\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">// src/resources/mod.rs</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #C678DD\">mod</span><span style=\"color: #ABB2BF\"> board_options;</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">pub</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">use</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">board_options</span><span style=\"color: #ABB2BF\">::*;</span></span></code></pre></div><p>在 <code>board_options</code> 文件中写入以下内容</p>\n<div class=\"language-rust\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">rust</span><pre class=\"shiki one-dark-pro\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">// src/resources/board_options.rs</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #C678DD\">use</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">bevy</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #E5C07B\">prelude</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #E5C07B\">Vec3</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">use</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">serde</span><span style=\"color: #ABB2BF\">::{</span><span style=\"color: #E5C07B\">Deserialize</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">Serialize</span><span style=\"color: #ABB2BF\">};</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">/// 格子大小设置</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">#[derive(</span><span style=\"color: #E5C07B\">Debug</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">Clone</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">Serialize</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">Deserialize</span><span style=\"color: #ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">pub</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">enum</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">TileSize</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">    /// 固定大小格子</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #61AFEF\">Fixed</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">f32</span><span style=\"color: #ABB2BF\">),</span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">    /// 窗口响应式格子</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #E5C07B\">Adaptive</span><span style=\"color: #ABB2BF\"> { </span><span style=\"color: #E06C75\">min</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">f32</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">max</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">f32</span><span style=\"color: #ABB2BF\"> },</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">}</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">/// 计分板位置设置</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">#[derive(</span><span style=\"color: #E5C07B\">Debug</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">Clone</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">Serialize</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">Deserialize</span><span style=\"color: #ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">pub</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">enum</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">BoardPosition</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">    /// 居中</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #E5C07B\">Centered</span><span style=\"color: #ABB2BF\"> { </span><span style=\"color: #E06C75\">offset</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Vec3</span><span style=\"color: #ABB2BF\"> },</span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">    /// 自定义位置</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #61AFEF\">Custom</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">Vec3</span><span style=\"color: #ABB2BF\">),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">}</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">/// 计分板生成选项 必须作为resource使用</span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">// 通过序列化保存和加载选项</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">#[derive(</span><span style=\"color: #E5C07B\">Debug</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">Clone</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">Serialize</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">Deserialize</span><span style=\"color: #ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">pub</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">struct</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">BoardOptions</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">    /// 地图大小</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #C678DD\">pub</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">map_size</span><span style=\"color: #ABB2BF\">: (</span><span style=\"color: #E5C07B\">u16</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">u16</span><span style=\"color: #ABB2BF\">),</span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">    /// 地雷数量</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #C678DD\">pub</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">bomb_count</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">u16</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">    /// 计分板位置</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #C678DD\">pub</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">position</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">BoardPosition</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">    /// 格子大小</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #C678DD\">pub</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">tile_size</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">TileSize</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">    /// 格子间距</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #C678DD\">pub</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">tile_padding</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">f32</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">    /// 是否启用点开的第一个格子必然是安全格子</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #C678DD\">pub</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">safe_start</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">bool</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">}</span></span></code></pre></div><p>下面为这些结构提供一些默认值</p>\n<div class=\"language-rust\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">rust</span><pre class=\"shiki one-dark-pro\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">// src/resources/board_options.rs</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">/// 格子大小默认值</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">impl</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">Default</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">for</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">TileSize</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #C678DD\">fn</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">default</span><span style=\"color: #ABB2BF\">() -&gt; </span><span style=\"color: #E5C07B\">Self</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E5C07B\">Self</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #E5C07B\">Adaptive</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E06C75\">min</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #D19A66\">10.0</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E06C75\">max</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #D19A66\">50.0</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">}</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">/// 计分板位置默认值</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">impl</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">Default</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">for</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">BoardPosition</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #C678DD\">fn</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">default</span><span style=\"color: #ABB2BF\">() -&gt; </span><span style=\"color: #E5C07B\">Self</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E5C07B\">Self</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #E5C07B\">Centered</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E06C75\">offset</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Default</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">default</span><span style=\"color: #ABB2BF\">(),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">}</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">/// 计分板选项默认值</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">impl</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">Default</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">for</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">BoardOptions</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #C678DD\">fn</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">default</span><span style=\"color: #ABB2BF\">() -&gt; </span><span style=\"color: #E5C07B\">Self</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E5C07B\">Self</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E06C75\">map_size</span><span style=\"color: #ABB2BF\">: (</span><span style=\"color: #D19A66\">15</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">15</span><span style=\"color: #ABB2BF\">),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E06C75\">bomb_count</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #D19A66\">30</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E06C75\">position</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Default</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">default</span><span style=\"color: #ABB2BF\">(),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E06C75\">tile_size</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Default</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">default</span><span style=\"color: #ABB2BF\">(),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E06C75\">tile_padding</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">.,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E06C75\">safe_start</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #D19A66\">false</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">}</span></span></code></pre></div><p>下面把这些资源注册到我们的主程序中</p>\n<div class=\"language-rust\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">rust</span><pre class=\"shiki one-dark-pro\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">// src/main.rs</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">// 新添加</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">use</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">minesweeper</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #E5C07B\">resources</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #E5C07B\">BoardOptions</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">// ..</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">// 此时的main函数</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">fn</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">main</span><span style=\"color: #ABB2BF\">() {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #C678DD\">let</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">mut</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">app</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">App</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">new</span><span style=\"color: #ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #E06C75\">app</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">insert_resource</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">WindowDescriptor</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E06C75\">title</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #98C379\">&quot;Mine Sweeper&quot;</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">to_string</span><span style=\"color: #ABB2BF\">(),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E06C75\">width</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #D19A66\">700</span><span style=\"color: #ABB2BF\">.,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E06C75\">height</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #D19A66\">800</span><span style=\"color: #ABB2BF\">.,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        ..</span><span style=\"color: #E5C07B\">Default</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">default</span><span style=\"color: #ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    })</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    .</span><span style=\"color: #61AFEF\">add_plugins</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">DefaultPlugins</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    #[cfg(feature </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">&quot;debug&quot;</span><span style=\"color: #ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #E06C75\">app</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">add_plugin</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">WorldInspectorPlugin</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">new</span><span style=\"color: #ABB2BF\">());</span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">    // 新加入内容 添加面板选项</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #E06C75\">app</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">insert_resource</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">BoardOptions</span><span style=\"color: #ABB2BF\">{</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E06C75\">map_size</span><span style=\"color: #ABB2BF\">:(</span><span style=\"color: #D19A66\">20</span><span style=\"color: #ABB2BF\">,</span><span style=\"color: #D19A66\">20</span><span style=\"color: #ABB2BF\">),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E06C75\">bomb_count</span><span style=\"color: #ABB2BF\">:</span><span style=\"color: #D19A66\">40</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E06C75\">tile_padding</span><span style=\"color: #ABB2BF\">:</span><span style=\"color: #D19A66\">3.0</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        ..</span><span style=\"color: #E5C07B\">Default</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">default</span><span style=\"color: #ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    });</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #E06C75\">app</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">add_plugin</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">BoardPlugin</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #E06C75\">app</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">add_startup_system</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">camera_setup</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #E06C75\">app</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">run</span><span style=\"color: #ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">}</span></span></code></pre></div><h1 id=\"生成面板\"><a href=\"#生成面板\" class=\"headerlink\" title=\"生成面板\"></a>生成面板</h1><p>还记得 <code>lib</code> 文件中 <code>BoardPlugin</code> 上的 <code>create_board</code> 方法吗, 现在让我们修改一下它的函数签名</p>\n<div class=\"language-rust\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">rust</span><pre class=\"shiki one-dark-pro\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">// src/lib.rs</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #C678DD\">use</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">resources</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #E5C07B\">BoardOptions</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">// ..</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">pub</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">fn</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">create_board</span><span style=\"color: #ABB2BF\">(</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #C678DD\">mut</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">commands</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Commands</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #E06C75\">board_options</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Option</span><span style=\"color: #ABB2BF\">&lt;</span><span style=\"color: #E5C07B\">Res</span><span style=\"color: #ABB2BF\">&lt;</span><span style=\"color: #E5C07B\">BoardOptions</span><span style=\"color: #ABB2BF\">&gt;&gt;,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #E06C75\">window</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Res</span><span style=\"color: #ABB2BF\">&lt;</span><span style=\"color: #E5C07B\">WindowDescriptor</span><span style=\"color: #ABB2BF\">&gt;,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    ) {..}</span></span></code></pre></div><p>为上述函数添加以下内容</p>\n<div class=\"language-rust\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">rust</span><pre class=\"shiki one-dark-pro\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">        // 生成选项是可选的, 因此如果未设置可以选择直接返回默认值</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">          </span><span style=\"color: #C678DD\">let</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">options</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">match</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">board_options</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E5C07B\">None</span><span style=\"color: #ABB2BF\"> =&gt; </span><span style=\"color: #E5C07B\">BoardOptions</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">default</span><span style=\"color: #ABB2BF\">(),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E5C07B\">Some</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">o</span><span style=\"color: #ABB2BF\">) =&gt; </span><span style=\"color: #E06C75\">o</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">clone</span><span style=\"color: #ABB2BF\">(),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        };</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">        // 地图生成</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #C678DD\">let</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">mut</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">tile_map</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">TileMap</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">empty</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">options</span><span style=\"color: #ABB2BF\">.map_size.</span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">options</span><span style=\"color: #ABB2BF\">.map_size.</span><span style=\"color: #D19A66\">1</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E06C75\">tile_map</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">set_bombs</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">options</span><span style=\"color: #ABB2BF\">.bomb_count);</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        #[cfg(feature </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">&quot;debug&quot;</span><span style=\"color: #ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">        // 地图调试选项</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E5C07B\">log</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">info!</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&quot;{}&quot;</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">tile_map</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">console_output</span><span style=\"color: #ABB2BF\">());</span></span></code></pre></div><h1 id=\"地砖大小\"><a href=\"#地砖大小\" class=\"headerlink\" title=\"地砖大小\"></a>地砖大小</h1><p>地砖的大小不能是一成不变的, 所以我们需要一个计算地砖大小与地图大小关系的方法. 将如下内容添加到 <code>BoardPlugin</code> 的方法中</p>\n<div class=\"language-rust\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">rust</span><pre class=\"shiki one-dark-pro\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">    /// 根据地图大小计算格子大小, 自适应属性</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #C678DD\">fn</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">adaptative_tile_size</span><span style=\"color: #ABB2BF\">(</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E06C75\">window</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Res</span><span style=\"color: #ABB2BF\">&lt;</span><span style=\"color: #E5C07B\">WindowDescriptor</span><span style=\"color: #ABB2BF\">&gt;,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        (</span><span style=\"color: #E06C75\">min</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">max</span><span style=\"color: #ABB2BF\">): (</span><span style=\"color: #E5C07B\">f32</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">f32</span><span style=\"color: #ABB2BF\">),</span><span style=\"color: #7F848E; font-style: italic\">      // Tile size constraints</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        (</span><span style=\"color: #E06C75\">width</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">height</span><span style=\"color: #ABB2BF\">): (</span><span style=\"color: #E5C07B\">u16</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">u16</span><span style=\"color: #ABB2BF\">),</span><span style=\"color: #7F848E; font-style: italic\"> // Tile map dimensions</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    ) -&gt; </span><span style=\"color: #E5C07B\">f32</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #C678DD\">let</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">max_width</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">window</span><span style=\"color: #ABB2BF\">.width / </span><span style=\"color: #E06C75\">width</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">as</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">f32</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #C678DD\">let</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">max_heigth</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">window</span><span style=\"color: #ABB2BF\">.height / </span><span style=\"color: #E06C75\">height</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">as</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">f32</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E06C75\">max_width</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">min</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">max_heigth</span><span style=\"color: #ABB2BF\">).</span><span style=\"color: #61AFEF\">clamp</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">min</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">max</span><span style=\"color: #ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    }</span></span></code></pre></div><p>接下来我们在 <code>create_board</code> 方法中调用此功能</p>\n<div class=\"language-rust\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">rust</span><pre class=\"shiki one-dark-pro\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">// 定义格子大小</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #C678DD\">let</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">tile_size</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">match</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">options</span><span style=\"color: #ABB2BF\">.tile_size {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E5C07B\">TileSize</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">Fixed</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">v</span><span style=\"color: #ABB2BF\">) =&gt; </span><span style=\"color: #E06C75\">v</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E5C07B\">TileSize</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #E5C07B\">Adaptive</span><span style=\"color: #ABB2BF\"> { </span><span style=\"color: #E06C75\">min</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">max</span><span style=\"color: #ABB2BF\"> } =&gt; </span><span style=\"color: #E5C07B\">Self</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">adaptative_tile_size</span><span style=\"color: #ABB2BF\">(</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E06C75\">window</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                (</span><span style=\"color: #E06C75\">min</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">max</span><span style=\"color: #ABB2BF\">),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                (</span><span style=\"color: #E06C75\">tile_map</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">width</span><span style=\"color: #ABB2BF\">(), </span><span style=\"color: #E06C75\">tile_map</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">height</span><span style=\"color: #ABB2BF\">()),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            ),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        };</span></span></code></pre></div><h3 id=\"面板属性\"><a href=\"#面板属性\" class=\"headerlink\" title=\"面板属性\"></a>面板属性</h3><p>接下来我们在 <code>create_board</code> 方法中添加如下内容</p>\n<div class=\"language-rust\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">rust</span><pre class=\"shiki one-dark-pro\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">        // 计算完整面板大小</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #C678DD\">let</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">board_size</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">Vec2</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">new</span><span style=\"color: #ABB2BF\">(</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E06C75\">tile_map</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">width</span><span style=\"color: #ABB2BF\">() </span><span style=\"color: #C678DD\">as</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">f32</span><span style=\"color: #ABB2BF\"> * </span><span style=\"color: #E06C75\">tile_size</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E06C75\">tile_map</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">height</span><span style=\"color: #ABB2BF\">() </span><span style=\"color: #C678DD\">as</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">f32</span><span style=\"color: #ABB2BF\"> * </span><span style=\"color: #E06C75\">tile_size</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        );</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E5C07B\">log</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">info!</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&quot;board size: {}&quot;</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">board_size</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">        // 面板板锚点位置（左下）</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #C678DD\">let</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">board_position</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">match</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">options</span><span style=\"color: #ABB2BF\">.position {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E5C07B\">BoardPosition</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #E5C07B\">Centered</span><span style=\"color: #ABB2BF\"> { </span><span style=\"color: #E06C75\">offset</span><span style=\"color: #ABB2BF\"> } =&gt; {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E5C07B\">Vec3</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">new</span><span style=\"color: #ABB2BF\">(-(</span><span style=\"color: #E06C75\">board_size</span><span style=\"color: #ABB2BF\">.x / </span><span style=\"color: #D19A66\">2</span><span style=\"color: #ABB2BF\">.), -(</span><span style=\"color: #E06C75\">board_size</span><span style=\"color: #ABB2BF\">.y / </span><span style=\"color: #D19A66\">2</span><span style=\"color: #ABB2BF\">.), </span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">.) + </span><span style=\"color: #E06C75\">offset</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            }</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E5C07B\">BoardPosition</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">Custom</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">p</span><span style=\"color: #ABB2BF\">) =&gt; </span><span style=\"color: #E06C75\">p</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        };</span></span></code></pre></div><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>注意：这里选择将面板锚定在左下角而不是中心, 相当于坐标原点位于左下角, 这样所有地砖的坐标相对就都是正数了</p></blockquote>\n<p>接下来就可以生成面板了</p>\n<p>继续加入以下内容</p>\n<div class=\"language-rust\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">rust</span><pre class=\"shiki one-dark-pro\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">// 生成面板</span></span>\n<span class=\"line\"><span style=\"color: #E06C75\">commands</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    .</span><span style=\"color: #61AFEF\">spawn</span><span style=\"color: #ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    .</span><span style=\"color: #61AFEF\">insert</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">Name</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">new</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&quot;Board&quot;</span><span style=\"color: #ABB2BF\">))</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    .</span><span style=\"color: #61AFEF\">insert</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">Transform</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">from_translation</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">board_position</span><span style=\"color: #ABB2BF\">))</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    .</span><span style=\"color: #61AFEF\">insert</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">GlobalTransform</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">default</span><span style=\"color: #ABB2BF\">())</span></span></code></pre></div><p>这里添加名字是为了后期调试用的, 这个名字将会被用于这个刚开始提到的社区调试插件中<br>下面我们添加背景, 用一些白色线条将地图切割成一个一个的小格子</p>\n<div class=\"language-rust\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">rust</span><pre class=\"shiki one-dark-pro\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">// ..</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">with_children</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #56B6C2\">|</span><span style=\"color: #E06C75\">parent</span><span style=\"color: #56B6C2\">|</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">    // 以计分板中间为锚点生成计分板背景</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #E06C75\">parent</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        .</span><span style=\"color: #61AFEF\">spawn_bundle</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">SpriteBundle</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E06C75\">sprite</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Sprite</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E06C75\">color</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Color</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #D19A66\">WHITE</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E06C75\">custom_size</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Some</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">board_size</span><span style=\"color: #ABB2BF\">),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                ..</span><span style=\"color: #E5C07B\">Default</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">default</span><span style=\"color: #ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            },</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E06C75\">transform</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Transform</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">from_xyz</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">board_size</span><span style=\"color: #ABB2BF\">.x / </span><span style=\"color: #D19A66\">2</span><span style=\"color: #ABB2BF\">., </span><span style=\"color: #E06C75\">board_size</span><span style=\"color: #ABB2BF\">.y / </span><span style=\"color: #D19A66\">2</span><span style=\"color: #ABB2BF\">., </span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">.),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            ..</span><span style=\"color: #E5C07B\">Default</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">default</span><span style=\"color: #ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        })</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        .</span><span style=\"color: #61AFEF\">insert</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">Name</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">new</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&quot;Background&quot;</span><span style=\"color: #ABB2BF\">));</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">})</span></span></code></pre></div><p>下面我们为每一个格子创建一个实体, 名字属性同样是用于后期调试的</p>\n<div class=\"language-rust\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">rust</span><pre class=\"shiki one-dark-pro\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">// ..</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">with_children</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #56B6C2\">|</span><span style=\"color: #E06C75\">parent</span><span style=\"color: #56B6C2\">|</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">    // 格子</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #C678DD\">for</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #E06C75\">y</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">line</span><span style=\"color: #ABB2BF\">) </span><span style=\"color: #C678DD\">in</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">tile_map</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">iter</span><span style=\"color: #ABB2BF\">().</span><span style=\"color: #61AFEF\">enumerate</span><span style=\"color: #ABB2BF\">() {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #C678DD\">for</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #E06C75\">x</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">tile</span><span style=\"color: #ABB2BF\">) </span><span style=\"color: #C678DD\">in</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">line</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">iter</span><span style=\"color: #ABB2BF\">().</span><span style=\"color: #61AFEF\">enumerate</span><span style=\"color: #ABB2BF\">() {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                    </span><span style=\"color: #E06C75\">parent</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                        .</span><span style=\"color: #61AFEF\">spawn_bundle</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">SpriteBundle</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                            </span><span style=\"color: #E06C75\">sprite</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Sprite</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                                </span><span style=\"color: #E06C75\">color</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Color</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #D19A66\">GRAY</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                                </span><span style=\"color: #E06C75\">custom_size</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Some</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">Vec2</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">splat</span><span style=\"color: #ABB2BF\">(</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                                    </span><span style=\"color: #E06C75\">tile_size</span><span style=\"color: #ABB2BF\"> - </span><span style=\"color: #E06C75\">options</span><span style=\"color: #ABB2BF\">.tile_padding </span><span style=\"color: #C678DD\">as</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">f32</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                                )),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                                ..</span><span style=\"color: #E5C07B\">Default</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">default</span><span style=\"color: #ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                            },</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                            </span><span style=\"color: #E06C75\">transform</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Transform</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">from_xyz</span><span style=\"color: #ABB2BF\">(</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                                (</span><span style=\"color: #E06C75\">x</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">as</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">f32</span><span style=\"color: #ABB2BF\"> * </span><span style=\"color: #E06C75\">tile_size</span><span style=\"color: #ABB2BF\">) + (</span><span style=\"color: #E06C75\">tile_size</span><span style=\"color: #ABB2BF\"> / </span><span style=\"color: #D19A66\">2</span><span style=\"color: #ABB2BF\">.),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                                (</span><span style=\"color: #E06C75\">y</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">as</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">f32</span><span style=\"color: #ABB2BF\"> * </span><span style=\"color: #E06C75\">tile_size</span><span style=\"color: #ABB2BF\">) + (</span><span style=\"color: #E06C75\">tile_size</span><span style=\"color: #ABB2BF\"> / </span><span style=\"color: #D19A66\">2</span><span style=\"color: #ABB2BF\">.),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                                </span><span style=\"color: #D19A66\">1</span><span style=\"color: #ABB2BF\">.,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                            ),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                            ..</span><span style=\"color: #E5C07B\">Default</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">default</span><span style=\"color: #ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                        })</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                        .</span><span style=\"color: #61AFEF\">insert</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">Name</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">new</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #61AFEF\">format!</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&quot;Tile ({}, {})&quot;</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">x</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">y</span><span style=\"color: #ABB2BF\">)))</span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">                        // 添加坐标组件到格子实体</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                        .</span><span style=\"color: #61AFEF\">insert</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">Coordinates</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                            </span><span style=\"color: #E06C75\">x</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E06C75\">x</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">as</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">u16</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                            </span><span style=\"color: #E06C75\">y</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E06C75\">y</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">as</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">u16</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                        });</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                }</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            }</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">});</span></span></code></pre></div><p>这次给 <code>lib</code> 文件添加了好多内容, 在此给出 <code>lib</code> 文件现在全部内容</p>\n<div class=\"language-rust\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">rust</span><pre class=\"shiki one-dark-pro\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">// src/lib.rs</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #C678DD\">pub</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">mod</span><span style=\"color: #ABB2BF\"> components;</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">pub</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">mod</span><span style=\"color: #ABB2BF\"> resources;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #C678DD\">use</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">bevy</span><span style=\"color: #ABB2BF\">::log;</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">use</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">bevy</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #E5C07B\">prelude</span><span style=\"color: #ABB2BF\">::*;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #C678DD\">use</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">resources</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #E5C07B\">tile_map</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #E5C07B\">TileMap</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">use</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">resources</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #E5C07B\">BoardOptions</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">use</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">resources</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #E5C07B\">BoardPosition</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">use</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">resources</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #E5C07B\">TileSize</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #C678DD\">use</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">components</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #E5C07B\">Coordinates</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">/// 面板插件</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">pub</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">struct</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">BoardPlugin</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #C678DD\">impl</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">Plugin</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">for</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">BoardPlugin</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #C678DD\">fn</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">build</span><span style=\"color: #ABB2BF\">(&amp;</span><span style=\"color: #E5C07B\">self</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">app</span><span style=\"color: #ABB2BF\">: &amp;</span><span style=\"color: #C678DD\">mut</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">App</span><span style=\"color: #ABB2BF\">) {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E06C75\">app</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">add_startup_system</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">Self</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #E06C75\">create_board</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E5C07B\">log</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">info!</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&quot;Loaded Board Plugin&quot;</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">}</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #C678DD\">impl</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">BoardPlugin</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">    /// 生成面板</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #C678DD\">pub</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">fn</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">create_board</span><span style=\"color: #ABB2BF\">(</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #C678DD\">mut</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">commands</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Commands</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E06C75\">board_options</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Option</span><span style=\"color: #ABB2BF\">&lt;</span><span style=\"color: #E5C07B\">Res</span><span style=\"color: #ABB2BF\">&lt;</span><span style=\"color: #E5C07B\">BoardOptions</span><span style=\"color: #ABB2BF\">&gt;&gt;,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E06C75\">window</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Res</span><span style=\"color: #ABB2BF\">&lt;</span><span style=\"color: #E5C07B\">WindowDescriptor</span><span style=\"color: #ABB2BF\">&gt;,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    ) {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #C678DD\">let</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">mut</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">tile_map</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">TileMap</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">empty</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #D19A66\">20</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">20</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E06C75\">tile_map</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">set_bombs</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #D19A66\">40</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        #[cfg(feature </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">&quot;debug&quot;</span><span style=\"color: #ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E5C07B\">log</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">info!</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&quot;{}&quot;</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">tile_map</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">console_output</span><span style=\"color: #ABB2BF\">());</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">        // 生成选项是可选的, 因此如果未设置可以选择直接返回默认值</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #C678DD\">let</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">options</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">match</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">board_options</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E5C07B\">None</span><span style=\"color: #ABB2BF\"> =&gt; </span><span style=\"color: #E5C07B\">BoardOptions</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">default</span><span style=\"color: #ABB2BF\">(),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E5C07B\">Some</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">o</span><span style=\"color: #ABB2BF\">) =&gt; </span><span style=\"color: #E06C75\">o</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">clone</span><span style=\"color: #ABB2BF\">(),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        };</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">        // 地图生成</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #C678DD\">let</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">mut</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">tile_map</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">TileMap</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">empty</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">options</span><span style=\"color: #ABB2BF\">.map_size.</span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">options</span><span style=\"color: #ABB2BF\">.map_size.</span><span style=\"color: #D19A66\">1</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E06C75\">tile_map</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">set_bombs</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">options</span><span style=\"color: #ABB2BF\">.bomb_count);</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        #[cfg(feature </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">&quot;debug&quot;</span><span style=\"color: #ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">        // 地图调试选项</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E5C07B\">log</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">info!</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&quot;{}&quot;</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">tile_map</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">console_output</span><span style=\"color: #ABB2BF\">());</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">        // 定义格子大小</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #C678DD\">let</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">tile_size</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">match</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">options</span><span style=\"color: #ABB2BF\">.tile_size {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E5C07B\">TileSize</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">Fixed</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">v</span><span style=\"color: #ABB2BF\">) =&gt; </span><span style=\"color: #E06C75\">v</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E5C07B\">TileSize</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #E5C07B\">Adaptive</span><span style=\"color: #ABB2BF\"> { </span><span style=\"color: #E06C75\">min</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">max</span><span style=\"color: #ABB2BF\"> } =&gt; </span><span style=\"color: #E5C07B\">Self</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">adaptative_tile_size</span><span style=\"color: #ABB2BF\">(</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E06C75\">window</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                (</span><span style=\"color: #E06C75\">min</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">max</span><span style=\"color: #ABB2BF\">),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                (</span><span style=\"color: #E06C75\">tile_map</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">width</span><span style=\"color: #ABB2BF\">(), </span><span style=\"color: #E06C75\">tile_map</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">height</span><span style=\"color: #ABB2BF\">()),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            ),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        };</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">        // 计算完整面板大小</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #C678DD\">let</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">board_size</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">Vec2</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">new</span><span style=\"color: #ABB2BF\">(</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E06C75\">tile_map</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">width</span><span style=\"color: #ABB2BF\">() </span><span style=\"color: #C678DD\">as</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">f32</span><span style=\"color: #ABB2BF\"> * </span><span style=\"color: #E06C75\">tile_size</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E06C75\">tile_map</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">height</span><span style=\"color: #ABB2BF\">() </span><span style=\"color: #C678DD\">as</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">f32</span><span style=\"color: #ABB2BF\"> * </span><span style=\"color: #E06C75\">tile_size</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        );</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E5C07B\">log</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">info!</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&quot;board size: {}&quot;</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">board_size</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">        // 面板板锚点位置（左下）</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #C678DD\">let</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">board_position</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">match</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">options</span><span style=\"color: #ABB2BF\">.position {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E5C07B\">BoardPosition</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #E5C07B\">Centered</span><span style=\"color: #ABB2BF\"> { </span><span style=\"color: #E06C75\">offset</span><span style=\"color: #ABB2BF\"> } =&gt; {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E5C07B\">Vec3</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">new</span><span style=\"color: #ABB2BF\">(-(</span><span style=\"color: #E06C75\">board_size</span><span style=\"color: #ABB2BF\">.x / </span><span style=\"color: #D19A66\">2</span><span style=\"color: #ABB2BF\">.), -(</span><span style=\"color: #E06C75\">board_size</span><span style=\"color: #ABB2BF\">.y / </span><span style=\"color: #D19A66\">2</span><span style=\"color: #ABB2BF\">.), </span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">.) + </span><span style=\"color: #E06C75\">offset</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            }</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E5C07B\">BoardPosition</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">Custom</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">p</span><span style=\"color: #ABB2BF\">) =&gt; </span><span style=\"color: #E06C75\">p</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        };</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">        // 生成面板</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E06C75\">commands</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            .</span><span style=\"color: #61AFEF\">spawn</span><span style=\"color: #ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            .</span><span style=\"color: #61AFEF\">insert</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">Name</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">new</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&quot;Board&quot;</span><span style=\"color: #ABB2BF\">))</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            .</span><span style=\"color: #61AFEF\">insert</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">Transform</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">from_translation</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">board_position</span><span style=\"color: #ABB2BF\">))</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            .</span><span style=\"color: #61AFEF\">insert</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">GlobalTransform</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">default</span><span style=\"color: #ABB2BF\">())</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            .</span><span style=\"color: #61AFEF\">with_children</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #56B6C2\">|</span><span style=\"color: #E06C75\">parent</span><span style=\"color: #56B6C2\">|</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">                // 以计分板中间为锚点生成计分板背景</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E06C75\">parent</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                    .</span><span style=\"color: #61AFEF\">spawn_bundle</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">SpriteBundle</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                        </span><span style=\"color: #E06C75\">sprite</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Sprite</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                            </span><span style=\"color: #E06C75\">color</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Color</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #D19A66\">WHITE</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                            </span><span style=\"color: #E06C75\">custom_size</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Some</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">board_size</span><span style=\"color: #ABB2BF\">),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                            ..</span><span style=\"color: #E5C07B\">Default</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">default</span><span style=\"color: #ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                        },</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                        </span><span style=\"color: #E06C75\">transform</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Transform</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">from_xyz</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">board_size</span><span style=\"color: #ABB2BF\">.x / </span><span style=\"color: #D19A66\">2</span><span style=\"color: #ABB2BF\">., </span><span style=\"color: #E06C75\">board_size</span><span style=\"color: #ABB2BF\">.y / </span><span style=\"color: #D19A66\">2</span><span style=\"color: #ABB2BF\">., </span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">.),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                        ..</span><span style=\"color: #E5C07B\">Default</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">default</span><span style=\"color: #ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                    })</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                    .</span><span style=\"color: #61AFEF\">insert</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">Name</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">new</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&quot;Background&quot;</span><span style=\"color: #ABB2BF\">));</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            })</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            .</span><span style=\"color: #61AFEF\">with_children</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #56B6C2\">|</span><span style=\"color: #E06C75\">parent</span><span style=\"color: #56B6C2\">|</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">                // 格子</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #C678DD\">for</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #E06C75\">y</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">line</span><span style=\"color: #ABB2BF\">) </span><span style=\"color: #C678DD\">in</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">tile_map</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">iter</span><span style=\"color: #ABB2BF\">().</span><span style=\"color: #61AFEF\">enumerate</span><span style=\"color: #ABB2BF\">() {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                            </span><span style=\"color: #C678DD\">for</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #E06C75\">x</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">tile</span><span style=\"color: #ABB2BF\">) </span><span style=\"color: #C678DD\">in</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">line</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">iter</span><span style=\"color: #ABB2BF\">().</span><span style=\"color: #61AFEF\">enumerate</span><span style=\"color: #ABB2BF\">() {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                                </span><span style=\"color: #E06C75\">parent</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                                    .</span><span style=\"color: #61AFEF\">spawn_bundle</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">SpriteBundle</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                                        </span><span style=\"color: #E06C75\">sprite</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Sprite</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                                            </span><span style=\"color: #E06C75\">color</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Color</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #D19A66\">GRAY</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                                            </span><span style=\"color: #E06C75\">custom_size</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Some</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">Vec2</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">splat</span><span style=\"color: #ABB2BF\">(</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                                                </span><span style=\"color: #E06C75\">tile_size</span><span style=\"color: #ABB2BF\"> - </span><span style=\"color: #E06C75\">options</span><span style=\"color: #ABB2BF\">.tile_padding </span><span style=\"color: #C678DD\">as</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">f32</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                                            )),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                                            ..</span><span style=\"color: #E5C07B\">Default</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">default</span><span style=\"color: #ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                                        },</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                                        </span><span style=\"color: #E06C75\">transform</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Transform</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">from_xyz</span><span style=\"color: #ABB2BF\">(</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                                            (</span><span style=\"color: #E06C75\">x</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">as</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">f32</span><span style=\"color: #ABB2BF\"> * </span><span style=\"color: #E06C75\">tile_size</span><span style=\"color: #ABB2BF\">) + (</span><span style=\"color: #E06C75\">tile_size</span><span style=\"color: #ABB2BF\"> / </span><span style=\"color: #D19A66\">2</span><span style=\"color: #ABB2BF\">.),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                                            (</span><span style=\"color: #E06C75\">y</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">as</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">f32</span><span style=\"color: #ABB2BF\"> * </span><span style=\"color: #E06C75\">tile_size</span><span style=\"color: #ABB2BF\">) + (</span><span style=\"color: #E06C75\">tile_size</span><span style=\"color: #ABB2BF\"> / </span><span style=\"color: #D19A66\">2</span><span style=\"color: #ABB2BF\">.),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                                            </span><span style=\"color: #D19A66\">1</span><span style=\"color: #ABB2BF\">.,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                                        ),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                                        ..</span><span style=\"color: #E5C07B\">Default</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">default</span><span style=\"color: #ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                                    })</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                                    .</span><span style=\"color: #61AFEF\">insert</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">Name</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">new</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #61AFEF\">format!</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&quot;Tile ({}, {})&quot;</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">x</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">y</span><span style=\"color: #ABB2BF\">)))</span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">                                    // 添加坐标组件到格子实体</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                                    .</span><span style=\"color: #61AFEF\">insert</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">Coordinates</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                                        </span><span style=\"color: #E06C75\">x</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E06C75\">x</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">as</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">u16</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                                        </span><span style=\"color: #E06C75\">y</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E06C75\">y</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">as</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">u16</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                                    });</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                            }</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                        }</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            });</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">    /// 根据地图大小计算格子大小, 自适应属性</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #C678DD\">fn</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">adaptative_tile_size</span><span style=\"color: #ABB2BF\">(</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E06C75\">window</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Res</span><span style=\"color: #ABB2BF\">&lt;</span><span style=\"color: #E5C07B\">WindowDescriptor</span><span style=\"color: #ABB2BF\">&gt;,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        (</span><span style=\"color: #E06C75\">min</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">max</span><span style=\"color: #ABB2BF\">): (</span><span style=\"color: #E5C07B\">f32</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">f32</span><span style=\"color: #ABB2BF\">),</span><span style=\"color: #7F848E; font-style: italic\">      // Tile size constraints</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        (</span><span style=\"color: #E06C75\">width</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">height</span><span style=\"color: #ABB2BF\">): (</span><span style=\"color: #E5C07B\">u16</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">u16</span><span style=\"color: #ABB2BF\">),</span><span style=\"color: #7F848E; font-style: italic\"> // Tile map dimensions</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    ) -&gt; </span><span style=\"color: #E5C07B\">f32</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #C678DD\">let</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">max_width</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">window</span><span style=\"color: #ABB2BF\">.width / </span><span style=\"color: #E06C75\">width</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">as</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">f32</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #C678DD\">let</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">max_heigth</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">window</span><span style=\"color: #ABB2BF\">.height / </span><span style=\"color: #E06C75\">height</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">as</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">f32</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E06C75\">max_width</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">min</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">max_heigth</span><span style=\"color: #ABB2BF\">).</span><span style=\"color: #61AFEF\">clamp</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">min</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">max</span><span style=\"color: #ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">}</span></span></code></pre></div><p>接下来运行 <code>cargo run --features debug</code> , 将会看到类似于这样的窗口<br><img src=\"https://fangtaluosi.top/img/blog/2022-03-05/2.png\" alt=\"图片缺失\"></p>\n<p>调试窗口可以更改许多游戏数据</p>\n<h1 id=\"地砖生成\"><a href=\"#地砖生成\" class=\"headerlink\" title=\"地砖生成\"></a>地砖生成</h1><h2 id=\"资源文件\"><a href=\"#资源文件\" class=\"headerlink\" title=\"资源文件\"></a>资源文件</h2><p>首先在根目录创建一个 <code>assets</code> 文件夹, Bevy 默认从此文件夹中寻找资源, 所以编译完成后, 也需要复制一份到二进制文件同级目录中, 我们需要地雷的贴图, 旗帜的贴图, 和一个你喜欢的字体文件</p>\n<p>接下来让我们再次修改 <code>create_board</code> 方法的签名</p>\n<div class=\"language-rust\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">rust</span><pre class=\"shiki one-dark-pro\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #C678DD\">pub</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">fn</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">create_board</span><span style=\"color: #ABB2BF\">(</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #C678DD\">mut</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">commands</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Commands</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #E06C75\">board_options</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Option</span><span style=\"color: #ABB2BF\">&lt;</span><span style=\"color: #E5C07B\">Res</span><span style=\"color: #ABB2BF\">&lt;</span><span style=\"color: #E5C07B\">BoardOptions</span><span style=\"color: #ABB2BF\">&gt;&gt;,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #E06C75\">window</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Res</span><span style=\"color: #ABB2BF\">&lt;</span><span style=\"color: #E5C07B\">WindowDescriptor</span><span style=\"color: #ABB2BF\">&gt;,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #E06C75\">asset_server</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Res</span><span style=\"color: #ABB2BF\">&lt;</span><span style=\"color: #E5C07B\">AssetServer</span><span style=\"color: #ABB2BF\">&gt;,</span><span style=\"color: #7F848E; font-style: italic\"> // 新添加, 允许我们从 assets 文件夹中加载资源</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">) {</span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">    // ...</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">}</span></span>\n<span class=\"line\"></span></code></pre></div><p>接下来添加这两行内容</p>\n<div class=\"language-rust\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">rust</span><pre class=\"shiki one-dark-pro\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">// src/lib.rs</span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">// ..</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #C678DD\">let</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">font</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">asset_server</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">load</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&quot;font.ttf&quot;</span><span style=\"color: #ABB2BF\">);</span><span style=\"color: #7F848E; font-style: italic\">//将会加载 assets/font.ttf 文件</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #C678DD\">let</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">bomb_image</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">asset_server</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">load</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&quot;img/bomb.png&quot;</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">// ..</span></span></code></pre></div><h2 id=\"地砖组件声明\"><a href=\"#地砖组件声明\" class=\"headerlink\" title=\"地砖组件声明\"></a>地砖组件声明</h2><p>为了让 ECS 知道哪些地砖是空的, 哪些有地雷, 我们需要如下组件</p>\n<div class=\"language-rust\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">rust</span><pre class=\"shiki one-dark-pro\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">// src/components/mod.rs</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #C678DD\">mod</span><span style=\"color: #ABB2BF\"> bomb;</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">mod</span><span style=\"color: #ABB2BF\"> bomb_neighbor;</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">mod</span><span style=\"color: #ABB2BF\"> uncover;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #C678DD\">pub</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">use</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">bomb</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #E5C07B\">Bomb</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">pub</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">use</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">bomb_neighbor</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #E5C07B\">BombNeighbor</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">pub</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">use</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">uncover</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #E5C07B\">Uncover</span><span style=\"color: #ABB2BF\">;</span></span></code></pre></div><p>其中每个文件的内容如下</p>\n<div class=\"language-rust\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">rust</span><pre class=\"shiki one-dark-pro\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">// src/components/bomb.rs</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">use</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">bevy</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #E5C07B\">prelude</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #E5C07B\">Component</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">/// 地雷组件</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">#[cfg_attr(feature </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">&quot;debug&quot;</span><span style=\"color: #ABB2BF\">, derive(bevy_inspector_egui::</span><span style=\"color: #E5C07B\">Inspectable</span><span style=\"color: #ABB2BF\">))]</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">#[derive(</span><span style=\"color: #E5C07B\">Debug</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">Copy</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">Clone</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">Ord</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">PartialOrd</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">Eq</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">PartialEq</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">Hash</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">Component</span><span style=\"color: #ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">pub</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">struct</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">Bomb</span><span style=\"color: #ABB2BF\">;</span></span></code></pre></div><div class=\"language-rust\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">rust</span><pre class=\"shiki one-dark-pro\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">// src/components/bomb_neighbor.rs</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #C678DD\">use</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">bevy</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #E5C07B\">prelude</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #E5C07B\">Component</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">/// 周围地雷组件</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">#[cfg_attr(feature </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">&quot;debug&quot;</span><span style=\"color: #ABB2BF\">, derive(bevy_inspector_egui::</span><span style=\"color: #E5C07B\">Inspectable</span><span style=\"color: #ABB2BF\">))]</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">#[derive(</span><span style=\"color: #E5C07B\">Debug</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">Copy</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">Clone</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">Ord</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">PartialOrd</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">Eq</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">PartialEq</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">Hash</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">Component</span><span style=\"color: #ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">pub</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">struct</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">BombNeighbor</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">    /// 周围地雷数量</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #C678DD\">pub</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">count</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">u8</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">}</span></span></code></pre></div><p>下面这个暂时用不到</p>\n<div class=\"language-rust\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">rust</span><pre class=\"shiki one-dark-pro\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">// src/components/uncover.rs</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #C678DD\">use</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">bevy</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #E5C07B\">prelude</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #E5C07B\">Component</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">/// 未开启的地砖组件</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">#[cfg_attr(feature </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">&quot;debug&quot;</span><span style=\"color: #ABB2BF\">, derive(bevy_inspector_egui::</span><span style=\"color: #E5C07B\">Inspectable</span><span style=\"color: #ABB2BF\">))]</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">#[derive(</span><span style=\"color: #E5C07B\">Debug</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">Copy</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">Clone</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">Ord</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">PartialOrd</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">Eq</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">PartialEq</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">Hash</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">Component</span><span style=\"color: #ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">pub</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">struct</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">Uncover</span><span style=\"color: #ABB2BF\">;</span></span></code></pre></div><p>接下来把这些组件注册到我们的插件中</p>\n<div class=\"language-rust\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">rust</span><pre class=\"shiki one-dark-pro\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">// src/lib.rs</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">#[cfg(feature </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">&quot;debug&quot;</span><span style=\"color: #ABB2BF\">)]</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">use</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">bevy_inspector_egui</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #E5C07B\">RegisterInspectable</span><span style=\"color: #ABB2BF\">;</span><span style=\"color: #7F848E; font-style: italic\">// 新添加</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">use</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">components</span><span style=\"color: #ABB2BF\">::*;</span><span style=\"color: #7F848E; font-style: italic\">//更改成全部引入</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #C678DD\">impl</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">Plugin</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">for</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">BoardPlugin</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #C678DD\">fn</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">build</span><span style=\"color: #ABB2BF\">(&amp;</span><span style=\"color: #E5C07B\">self</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">app</span><span style=\"color: #ABB2BF\">: &amp;</span><span style=\"color: #C678DD\">mut</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">App</span><span style=\"color: #ABB2BF\">) {</span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">        // ..</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        #[cfg(feature </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">&quot;debug&quot;</span><span style=\"color: #ABB2BF\">)]</span><span style=\"color: #7F848E; font-style: italic\">// 新添加</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        {</span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">            // 将自定义组件注册到调试窗口</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E06C75\">app</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">register_inspectable</span><span style=\"color: #ABB2BF\">::&lt;</span><span style=\"color: #E5C07B\">Coordinates</span><span style=\"color: #ABB2BF\">&gt;();</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E06C75\">app</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">register_inspectable</span><span style=\"color: #ABB2BF\">::&lt;</span><span style=\"color: #E5C07B\">BombNeighbor</span><span style=\"color: #ABB2BF\">&gt;();</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E06C75\">app</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">register_inspectable</span><span style=\"color: #ABB2BF\">::&lt;</span><span style=\"color: #E5C07B\">Bomb</span><span style=\"color: #ABB2BF\">&gt;();</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E06C75\">app</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">register_inspectable</span><span style=\"color: #ABB2BF\">::&lt;</span><span style=\"color: #E5C07B\">Uncover</span><span style=\"color: #ABB2BF\">&gt;();</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">}</span></span></code></pre></div><p>接下来为 <code>BoardPlugin</code> 创建一个生成 <strong>周围生成地雷数量</strong> 的方法</p>\n<div class=\"language-rust\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">rust</span><pre class=\"shiki one-dark-pro\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">// src/lib.rs</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">/// 周围生成地雷数</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">fn</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">bomb_count_text_bundle</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">count</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">u8</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">font</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Handle</span><span style=\"color: #ABB2BF\">&lt;</span><span style=\"color: #E5C07B\">Font</span><span style=\"color: #ABB2BF\">&gt;, </span><span style=\"color: #E06C75\">size</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">f32</span><span style=\"color: #ABB2BF\">) -&gt; </span><span style=\"color: #E5C07B\">Text2dBundle</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">    // We retrieve the text and the correct color</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #C678DD\">let</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #E06C75\">text</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">color</span><span style=\"color: #ABB2BF\">) </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> (</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E06C75\">count</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">to_string</span><span style=\"color: #ABB2BF\">(),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #C678DD\">match</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">count</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #D19A66\">1</span><span style=\"color: #ABB2BF\"> =&gt; </span><span style=\"color: #E5C07B\">Color</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #D19A66\">WHITE</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #D19A66\">2</span><span style=\"color: #ABB2BF\"> =&gt; </span><span style=\"color: #E5C07B\">Color</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #D19A66\">GREEN</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #D19A66\">3</span><span style=\"color: #ABB2BF\"> =&gt; </span><span style=\"color: #E5C07B\">Color</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #D19A66\">YELLOW</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #D19A66\">4</span><span style=\"color: #ABB2BF\"> =&gt; </span><span style=\"color: #E5C07B\">Color</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #D19A66\">ORANGE</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E06C75\">_</span><span style=\"color: #ABB2BF\"> =&gt; </span><span style=\"color: #E5C07B\">Color</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #D19A66\">PURPLE</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        },</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    );</span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">    // 生成一段文本</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #E5C07B\">Text2dBundle</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E06C75\">text</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Text</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E06C75\">sections</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #61AFEF\">vec!</span><span style=\"color: #ABB2BF\">[</span><span style=\"color: #E5C07B\">TextSection</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E06C75\">value</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E06C75\">text</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E06C75\">style</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">TextStyle</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                    </span><span style=\"color: #E06C75\">color</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                    </span><span style=\"color: #E06C75\">font</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                    </span><span style=\"color: #E06C75\">font_size</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E06C75\">size</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                },</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            }],</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E06C75\">alignment</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">TextAlignment</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E06C75\">vertical</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">VerticalAlign</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #E5C07B\">Center</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E06C75\">horizontal</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">HorizontalAlign</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #E5C07B\">Center</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            },</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        },</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E06C75\">transform</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Transform</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">from_xyz</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">., </span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">., </span><span style=\"color: #D19A66\">1</span><span style=\"color: #ABB2BF\">.),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        ..</span><span style=\"color: #E5C07B\">Default</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">default</span><span style=\"color: #ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">}</span></span></code></pre></div><p>再为 <code>BoardPlugin</code> 创建一个生成生成地砖贴图的方法</p>\n<div class=\"language-rust\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">rust</span><pre class=\"shiki one-dark-pro\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">// src/lib.rs</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #C678DD\">fn</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">spawn_tiles</span><span style=\"color: #ABB2BF\">(</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #E06C75\">parent</span><span style=\"color: #ABB2BF\">: &amp;</span><span style=\"color: #C678DD\">mut</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">ChildBuilder</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #E06C75\">tile_map</span><span style=\"color: #ABB2BF\">: &amp;</span><span style=\"color: #E5C07B\">TileMap</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #E06C75\">size</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">f32</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #E06C75\">padding</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">f32</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #E06C75\">color</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Color</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #E06C75\">bomb_image</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Handle</span><span style=\"color: #ABB2BF\">&lt;</span><span style=\"color: #E5C07B\">Image</span><span style=\"color: #ABB2BF\">&gt;,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #E06C75\">font</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Handle</span><span style=\"color: #ABB2BF\">&lt;</span><span style=\"color: #E5C07B\">Font</span><span style=\"color: #ABB2BF\">&gt;,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">) {</span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">    // 地砖</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #C678DD\">for</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #E06C75\">y</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">line</span><span style=\"color: #ABB2BF\">) </span><span style=\"color: #C678DD\">in</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">tile_map</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">iter</span><span style=\"color: #ABB2BF\">().</span><span style=\"color: #61AFEF\">enumerate</span><span style=\"color: #ABB2BF\">() {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #C678DD\">for</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #E06C75\">x</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">tile</span><span style=\"color: #ABB2BF\">) </span><span style=\"color: #C678DD\">in</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">line</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">iter</span><span style=\"color: #ABB2BF\">().</span><span style=\"color: #61AFEF\">enumerate</span><span style=\"color: #ABB2BF\">() {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #C678DD\">let</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">coordinates</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">Coordinates</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">              </span><span style=\"color: #E06C75\">x</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E06C75\">x</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">as</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">u16</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">              </span><span style=\"color: #E06C75\">y</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E06C75\">y</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">as</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">u16</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            };</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #C678DD\">let</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">mut</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">cmd</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">parent</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">spawn</span><span style=\"color: #ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E06C75\">cmd</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">insert_bundle</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">SpriteBundle</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E06C75\">sprite</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Sprite</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                    </span><span style=\"color: #E06C75\">color</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                    </span><span style=\"color: #E06C75\">custom_size</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Some</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">Vec2</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">splat</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">size</span><span style=\"color: #ABB2BF\"> - </span><span style=\"color: #E06C75\">padding</span><span style=\"color: #ABB2BF\">)),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                    ..</span><span style=\"color: #E5C07B\">Default</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">default</span><span style=\"color: #ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                },</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E06C75\">transform</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Transform</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">from_xyz</span><span style=\"color: #ABB2BF\">(</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                    (</span><span style=\"color: #E06C75\">x</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">as</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">f32</span><span style=\"color: #ABB2BF\"> * </span><span style=\"color: #E06C75\">size</span><span style=\"color: #ABB2BF\">) + (</span><span style=\"color: #E06C75\">size</span><span style=\"color: #ABB2BF\"> / </span><span style=\"color: #D19A66\">2</span><span style=\"color: #ABB2BF\">.),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                    (</span><span style=\"color: #E06C75\">y</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">as</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">f32</span><span style=\"color: #ABB2BF\"> * </span><span style=\"color: #E06C75\">size</span><span style=\"color: #ABB2BF\">) + (</span><span style=\"color: #E06C75\">size</span><span style=\"color: #ABB2BF\"> / </span><span style=\"color: #D19A66\">2</span><span style=\"color: #ABB2BF\">.),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                    </span><span style=\"color: #D19A66\">1</span><span style=\"color: #ABB2BF\">.,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                ),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                ..</span><span style=\"color: #E5C07B\">Default</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">default</span><span style=\"color: #ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            })</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            .</span><span style=\"color: #61AFEF\">insert</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">Name</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">new</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #61AFEF\">format!</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&quot;Tile ({}, {})&quot;</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">x</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">y</span><span style=\"color: #ABB2BF\">)))</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            .</span><span style=\"color: #61AFEF\">insert</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">coordinates</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">}</span></span></code></pre></div><p>接着我们可以调用该方法生成地砖, 在create_board方法中, 大概在下面这个位置上</p>\n<div class=\"language-rust\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">rust</span><pre class=\"shiki one-dark-pro\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">// src/lib</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #E06C75\">commands</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    .</span><span style=\"color: #61AFEF\">spawn</span><span style=\"color: #ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    .</span><span style=\"color: #61AFEF\">insert</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">Name</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">new</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&quot;Board&quot;</span><span style=\"color: #ABB2BF\">))</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    .</span><span style=\"color: #61AFEF\">insert</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">Transform</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">from_translation</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">board_position</span><span style=\"color: #ABB2BF\">))</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    .</span><span style=\"color: #61AFEF\">insert</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">GlobalTransform</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">default</span><span style=\"color: #ABB2BF\">())</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    .</span><span style=\"color: #61AFEF\">with_children</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #56B6C2\">|</span><span style=\"color: #E06C75\">parent</span><span style=\"color: #56B6C2\">|</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E06C75\">parent</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            .</span><span style=\"color: #61AFEF\">spawn_bundle</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">SpriteBundle</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E06C75\">sprite</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Sprite</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                    </span><span style=\"color: #E06C75\">color</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Color</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #D19A66\">WHITE</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                    </span><span style=\"color: #E06C75\">custom_size</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Some</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">board_size</span><span style=\"color: #ABB2BF\">),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                    ..</span><span style=\"color: #E5C07B\">Default</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">default</span><span style=\"color: #ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                },</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E06C75\">transform</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Transform</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">from_xyz</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">board_size</span><span style=\"color: #ABB2BF\">.x / </span><span style=\"color: #D19A66\">2</span><span style=\"color: #ABB2BF\">., </span><span style=\"color: #E06C75\">board_size</span><span style=\"color: #ABB2BF\">.y / </span><span style=\"color: #D19A66\">2</span><span style=\"color: #ABB2BF\">., </span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">.),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                ..</span><span style=\"color: #E5C07B\">Default</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">default</span><span style=\"color: #ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            })</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            .</span><span style=\"color: #61AFEF\">insert</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">Name</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">new</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&quot;Background&quot;</span><span style=\"color: #ABB2BF\">));</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E5C07B\">Self</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">spawn_tiles</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #7F848E; font-style: italic\">//新添加</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E06C75\">parent</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                &amp;</span><span style=\"color: #E06C75\">tile_map</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E06C75\">tile_size</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E06C75\">options</span><span style=\"color: #ABB2BF\">.tile_padding,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E5C07B\">Color</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #D19A66\">GRAY</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E06C75\">bomb_image</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E06C75\">font</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            );</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    });</span></span></code></pre></div><p>最后, 完成上面那个生成贴图, 在双循环中加入贴图与文本</p>\n<div class=\"language-rust\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">rust</span><pre class=\"shiki one-dark-pro\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">// src/lib.rs</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #C678DD\">use</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">resources</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #E5C07B\">tile</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #E5C07B\">Tile</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">// ..</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">match</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">tile</span><span style=\"color: #ABB2BF\"> {</span><span style=\"color: #7F848E; font-style: italic\">// 放入spawn_tiles方法内层for循环下部</span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">    // 如果是地雷就添加对应组件和贴图</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #E5C07B\">Tile</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #E5C07B\">Bomb</span><span style=\"color: #ABB2BF\"> =&gt; {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E06C75\">cmd</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">insert</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">Bomb</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E06C75\">cmd</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">with_children</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #56B6C2\">|</span><span style=\"color: #E06C75\">parent</span><span style=\"color: #56B6C2\">|</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E06C75\">parent</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">spawn_bundle</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">SpriteBundle</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E06C75\">sprite</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Sprite</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                    </span><span style=\"color: #E06C75\">custom_size</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Some</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">Vec2</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">splat</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">size</span><span style=\"color: #ABB2BF\"> - </span><span style=\"color: #E06C75\">padding</span><span style=\"color: #ABB2BF\">)),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                    ..</span><span style=\"color: #E5C07B\">Default</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">default</span><span style=\"color: #ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                },</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E06C75\">transform</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E5C07B\">Transform</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">from_xyz</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">., </span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">., </span><span style=\"color: #D19A66\">1</span><span style=\"color: #ABB2BF\">.),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E06C75\">texture</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E06C75\">bomb_image</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">clone</span><span style=\"color: #ABB2BF\">(),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                ..</span><span style=\"color: #E5C07B\">Default</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">default</span><span style=\"color: #ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            });</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        });</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">    // 如果是地雷周围的格子及空格子就添加对应文本的组件</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #E5C07B\">Tile</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">BombNeighbor</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">v</span><span style=\"color: #ABB2BF\">) =&gt; {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E06C75\">cmd</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">insert</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">BombNeighbor</span><span style=\"color: #ABB2BF\"> { </span><span style=\"color: #E06C75\">count</span><span style=\"color: #ABB2BF\">: *</span><span style=\"color: #E06C75\">v</span><span style=\"color: #ABB2BF\"> });</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E06C75\">cmd</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">with_children</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #56B6C2\">|</span><span style=\"color: #E06C75\">parent</span><span style=\"color: #56B6C2\">|</span><span style=\"color: #ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E06C75\">parent</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">spawn_bundle</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">Self</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #61AFEF\">bomb_count_text_bundle</span><span style=\"color: #ABB2BF\">(</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                *</span><span style=\"color: #E06C75\">v</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E06C75\">font</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">clone</span><span style=\"color: #ABB2BF\">(),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E06C75\">size</span><span style=\"color: #ABB2BF\"> - </span><span style=\"color: #E06C75\">padding</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            ));</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        });</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #E5C07B\">Tile</span><span style=\"color: #ABB2BF\">::</span><span style=\"color: #E5C07B\">Empty</span><span style=\"color: #ABB2BF\"> =&gt; (),</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">}</span></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">// ..</span></span></code></pre></div><p>接下来运行 <code>cargo run --features debug</code>, 将会看到类似于这样的窗口<br><img src=\"https://fangtaluosi.top/img/blog/2022-03-05/3.png\" alt=\"图片缺失\"></p>\n","feature":false,"text":"基于Bevy的扫雷游戏, 地图绘制...","permalink":"/post/2022-03-27","photos":[],"count_time":{"symbolsCount":"18k","symbolsTime":"17 mins."},"categories":[{"name":"Course","slug":"Course","count":11,"path":"api/categories/Course.json"}],"tags":[{"name":"Bevy","slug":"Bevy","count":2,"path":"api/tags/Bevy.json"},{"name":"Rust","slug":"Rust","count":12,"path":"api/tags/Rust.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#Board-Options\"><span class=\"toc-text\">Board Options</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E7%94%9F%E6%88%90%E9%9D%A2%E6%9D%BF\"><span class=\"toc-text\">生成面板</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%9C%B0%E7%A0%96%E5%A4%A7%E5%B0%8F\"><span class=\"toc-text\">地砖大小</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E9%9D%A2%E6%9D%BF%E5%B1%9E%E6%80%A7\"><span class=\"toc-text\">面板属性</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%9C%B0%E7%A0%96%E7%94%9F%E6%88%90\"><span class=\"toc-text\">地砖生成</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6\"><span class=\"toc-text\">资源文件</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%9C%B0%E7%A0%96%E7%BB%84%E4%BB%B6%E5%A3%B0%E6%98%8E\"><span class=\"toc-text\">地砖组件声明</span></a></li></ol></li></ol>","author":{"name":"芳塔洛斯","slug":"blog-author","avatar":"https://fontlos.com/icons/avatar.jpg","link":"/","description":"来人间一趟, 为散步一场<br />待走出岁月, 何样的彼方<br />才配得上这一路的颠沛与时光","socials":{"github":"https://github.com/fontlos","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"https://fontlos.com/icons/bilibili.svg","link":"https://space.bilibili.com/362772872"}}}},"mapped":true,"hidden":false,"prev_post":{"title":"基于 Hexo + Aurora + GitTalk 的博客项目, 并通过 Github Action 持续集成","uid":"6fd3072f35c36cdb6dca04682272855c","slug":"2023-08-30","date":"2023-08-30T02:33:17.000Z","updated":"2024-03-06T02:36:48.103Z","comments":true,"path":"api/articles/2023-08-30.json","keywords":"Programming, Web, Frontend, Backend ,Rust, Blog, Aurora, Fontlos, 芳塔洛斯","cover":"https://fontlos.com/icons/logo.png","text":"创建项目官方的教程 写的很清楚, 这里简单概括一下 建议使用 Yarn 或 Pnpm, 这里我采用 Pnpm 作为演示 首先安装全局 Hexo Cli 工具 s...","permalink":"/post/2023-08-30","photos":[],"count_time":{"symbolsCount":"6.4k","symbolsTime":"6 mins."},"categories":[{"name":"Note","slug":"Note","count":9,"path":"api/categories/Note.json"}],"tags":[{"name":"Frontend","slug":"Frontend","count":5,"path":"api/tags/Frontend.json"},{"name":"Hexo","slug":"Hexo","count":3,"path":"api/tags/Hexo.json"},{"name":"Web","slug":"Web","count":1,"path":"api/tags/Web.json"}],"author":{"name":"芳塔洛斯","slug":"blog-author","avatar":"https://fontlos.com/icons/avatar.jpg","link":"/","description":"来人间一趟, 为散步一场<br />待走出岁月, 何样的彼方<br />才配得上这一路的颠沛与时光","socials":{"github":"https://github.com/fontlos","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"https://fontlos.com/icons/bilibili.svg","link":"https://space.bilibili.com/362772872"}}}},"feature":false},"next_post":{"title":"基于Bevy的扫雷游戏(1)","uid":"649086876175b6262b284227d70ea0a8","slug":"2022-03-05","date":"2022-03-05T06:01:03.000Z","updated":"2024-03-06T02:36:48.103Z","comments":true,"path":"api/articles/2022-03-05.json","keywords":"Programming, Web, Frontend, Backend ,Rust, Blog, Aurora, Fontlos, 芳塔洛斯","cover":"https://fontlos.com/cover/bevy.svg","text":" 注意 文章重写中 介绍Bevy 是一个免费开源的游戏引擎, 用 Rust 编写, 采用 ECS 范式, 接下来让我们基于 Bevy 实现一个扫雷游戏 准备首先...","permalink":"/post/2022-03-05","photos":[],"count_time":{"symbolsCount":"10k","symbolsTime":"9 mins."},"categories":[{"name":"Course","slug":"Course","count":11,"path":"api/categories/Course.json"}],"tags":[{"name":"Bevy","slug":"Bevy","count":2,"path":"api/tags/Bevy.json"},{"name":"Rust","slug":"Rust","count":12,"path":"api/tags/Rust.json"}],"author":{"name":"芳塔洛斯","slug":"blog-author","avatar":"https://fontlos.com/icons/avatar.jpg","link":"/","description":"来人间一趟, 为散步一场<br />待走出岁月, 何样的彼方<br />才配得上这一路的颠沛与时光","socials":{"github":"https://github.com/fontlos","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"https://fontlos.com/icons/bilibili.svg","link":"https://space.bilibili.com/362772872"}}}},"feature":false}}